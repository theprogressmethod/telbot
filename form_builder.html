<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Builder System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .form-title {
            font-size: 28px;
            margin-bottom: 10px;
            color: #1a202c;
        }
        
        .form-description {
            color: #64748b;
            margin-bottom: 30px;
        }
        
        .form-field {
            margin-bottom: 24px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #334155;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option-card {
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .option-card:hover {
            border-color: #667eea;
            background: #f8faff;
        }
        
        .option-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
        }
        
        .step { display: none; }
        .step.active { display: block; }
        
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 30px;
        }
        
        .error {
            color: #ef4444;
            font-size: 14px;
            margin-top: 6px;
        }
        
        .required { color: #ef4444; }
    </style>
</head>
<body>
    <div class="container" id="formContainer">
        <!-- Form will be rendered here -->
    </div>

    <script>
        // Form Configuration System
        class FormBuilder {
            constructor(config) {
                this.config = config;
                this.currentStep = 0;
                this.formData = {};
                this.container = document.getElementById('formContainer');
            }
            
            render() {
                if (this.config.type === 'single') {
                    this.renderSinglePage();
                } else {
                    this.renderMultiStep();
                }
            }
            
            renderSinglePage() {
                let html = `
                    <h1 class="form-title">${this.config.title}</h1>
                    <p class="form-description">${this.config.description || ''}</p>
                    <form id="dynamicForm">
                `;
                
                this.config.fields.forEach(field => {
                    html += this.renderField(field);
                });
                
                html += `
                    <button type="submit" class="btn btn-primary">
                        ${this.config.submitText || 'Submit'}
                    </button>
                    </form>
                `;
                
                this.container.innerHTML = html;
                this.attachEventListeners();
            }
            
            renderMultiStep() {
                const step = this.config.steps[this.currentStep];
                const progress = ((this.currentStep + 1) / this.config.steps.length) * 100;
                
                let html = `
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    <h1 class="form-title">${step.title}</h1>
                    <p class="form-description">${step.description || ''}</p>
                    <form id="dynamicForm">
                `;
                
                step.fields.forEach(field => {
                    html += this.renderField(field);
                });
                
                html += '<div class="button-group">';
                
                if (this.currentStep > 0) {
                    html += '<button type="button" class="btn" onclick="form.previousStep()">Back</button>';
                }
                
                if (this.currentStep < this.config.steps.length - 1) {
                    html += '<button type="button" class="btn btn-primary" onclick="form.nextStep()">Continue</button>';
                } else {
                    html += `<button type="submit" class="btn btn-primary">${this.config.submitText || 'Submit'}</button>`;
                }
                
                html += '</div></form>';
                
                this.container.innerHTML = html;
                this.attachEventListeners();
            }
            
            renderField(field) {
                let html = '<div class="form-field">';
                
                if (field.label) {
                    html += `<label>${field.label}`;
                    if (field.required) html += ' <span class="required">*</span>';
                    html += '</label>';
                }
                
                switch (field.type) {
                    case 'text':
                    case 'email':
                    case 'tel':
                        html += `<input type="${field.type}" name="${field.name}" 
                                 placeholder="${field.placeholder || ''}"
                                 ${field.required ? 'required' : ''}>`;
                        break;
                        
                    case 'textarea':
                        html += `<textarea name="${field.name}" 
                                 placeholder="${field.placeholder || ''}"
                                 rows="${field.rows || 4}"
                                 ${field.required ? 'required' : ''}></textarea>`;
                        break;
                        
                    case 'select':
                        html += `<select name="${field.name}" ${field.required ? 'required' : ''}>`;
                        html += '<option value="">Choose...</option>';
                        field.options.forEach(opt => {
                            html += `<option value="${opt.value}">${opt.label}</option>`;
                        });
                        html += '</select>';
                        break;
                        
                    case 'radio':
                        html += '<div class="radio-group">';
                        field.options.forEach(opt => {
                            html += `
                                <div class="option-card" onclick="this.querySelector('input').checked=true">
                                    <input type="radio" name="${field.name}" value="${opt.value}">
                                    <label>${opt.label}</label>
                                </div>
                            `;
                        });
                        html += '</div>';
                        break;
                        
                    case 'checkbox':
                        html += '<div class="checkbox-group">';
                        field.options.forEach(opt => {
                            html += `
                                <div class="option-card" onclick="var c=this.querySelector('input');c.checked=!c.checked">
                                    <input type="checkbox" name="${field.name}" value="${opt.value}">
                                    <label>${opt.label}</label>
                                </div>
                            `;
                        });
                        html += '</div>';
                        break;
                }
                
                if (field.helpText) {
                    html += `<small style="color: #64748b; margin-top: 6px; display: block;">${field.helpText}</small>`;
                }
                
                html += '</div>';
                return html;
            }
            
            attachEventListeners() {
                const form = document.getElementById('dynamicForm');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleSubmit();
                });
                
                // Add selected class to option cards
                document.querySelectorAll('.option-card').forEach(card => {
                    card.addEventListener('click', function() {
                        if (this.querySelector('input[type="radio"]')) {
                            this.parentElement.querySelectorAll('.option-card').forEach(c => {
                                c.classList.remove('selected');
                            });
                        }
                        this.classList.toggle('selected');
                    });
                });
            }
            
            nextStep() {
                if (this.validateCurrentStep()) {
                    this.saveStepData();
                    this.currentStep++;
                    this.renderMultiStep();
                }
            }
            
            previousStep() {
                this.currentStep--;
                this.renderMultiStep();
            }
            
            validateCurrentStep() {
                const form = document.getElementById('dynamicForm');
                return form.checkValidity();
            }
            
            saveStepData() {
                const formData = new FormData(document.getElementById('dynamicForm'));
                for (let [key, value] of formData.entries()) {
                    this.formData[key] = value;
                }
            }
            
            async handleSubmit() {
                if (this.config.type === 'multi') {
                    this.saveStepData();
                } else {
                    const formData = new FormData(document.getElementById('dynamicForm'));
                    for (let [key, value] of formData.entries()) {
                        this.formData[key] = value;
                    }
                }
                
                // Call webhook
                if (this.config.webhook) {
                    try {
                        const response = await fetch(this.config.webhook, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.formData)
                        });
                        
                        if (response.ok) {
                            this.showSuccess();
                        }
                    } catch (error) {
                        console.error('Submission error:', error);
                    }
                }
                
                // Call custom handler
                if (this.config.onSubmit) {
                    this.config.onSubmit(this.formData);
                }
            }
            
            showSuccess() {
                this.container.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <div style="font-size: 60px; margin-bottom: 20px;">✅</div>
                        <h2>Success!</h2>
                        <p style="color: #64748b; margin-top: 10px;">
                            ${this.config.successMessage || 'Your form has been submitted.'}
                        </p>
                    </div>
                `;
            }
        }
        
        // EXAMPLE: Create any form with JSON configuration
        const formConfig = {
            type: 'multi', // 'single' or 'multi'
            title: 'Join Accountability Pod',
            webhook: 'https://telbot-f4on.onrender.com/apply',
            submitText: 'Complete Application',
            successMessage: 'Application received! Check your email.',
            steps: [
                {
                    title: "Let's start with your name",
                    fields: [
                        {
                            type: 'text',
                            name: 'firstName',
                            label: 'First Name',
                            placeholder: 'John',
                            required: true
                        },
                        {
                            type: 'email',
                            name: 'email',
                            label: 'Email Address',
                            placeholder: 'john@example.com',
                            required: true
                        }
                    ]
                },
                {
                    title: "What's your main goal?",
                    description: "Think 90 days from now",
                    fields: [
                        {
                            type: 'textarea',
                            name: 'goal',
                            label: 'Describe your goal',
                            placeholder: 'Be specific about what success looks like...',
                            required: true,
                            rows: 5
                        }
                    ]
                },
                {
                    title: "Choose your commitment level",
                    fields: [
                        {
                            type: 'radio',
                            name: 'commitment',
                            label: 'How committed are you?',
                            required: true,
                            options: [
                                { value: '10', label: "10 - I'll do whatever it takes" },
                                { value: '8', label: "8 - Very committed with support" },
                                { value: '6', label: "6 - Committed but need consistency" },
                                { value: '4', label: "4 - Still figuring things out" }
                            ]
                        }
                    ]
                },
                {
                    title: "When can you meet?",
                    fields: [
                        {
                            type: 'select',
                            name: 'timezone',
                            label: 'Your Timezone',
                            required: true,
                            options: [
                                { value: 'PST', label: 'PST - Pacific Time' },
                                { value: 'EST', label: 'EST - Eastern Time' },
                                { value: 'CST', label: 'CST - Central Time' },
                                { value: 'GMT', label: 'GMT - London' }
                            ]
                        },
                        {
                            type: 'checkbox',
                            name: 'availability',
                            label: 'Available Days',
                            options: [
                                { value: 'mon', label: 'Monday' },
                                { value: 'tue', label: 'Tuesday' },
                                { value: 'wed', label: 'Wednesday' },
                                { value: 'thu', label: 'Thursday' },
                                { value: 'fri', label: 'Friday' }
                            ]
                        }
                    ]
                }
            ]
        };
        
        // Initialize the form
        const form = new FormBuilder(formConfig);
        form.render();
    </script>
</body>
</html>